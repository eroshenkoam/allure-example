name: Java CI

on: [ push ]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: | 
          wget https://github.com/allure-framework/allurectl/releases/latest/download/allurectl_linux_386 -O ./allurectl
          printenv | grep "ALLURE\|GITHUB" > env.list
        env:
          ALLURE_ENDPOINT: https://demo.testops.cloud
          ALLURE_TOKEN: ${{ secrets.ALLURE_TOKEN }}
          ALLURE_PROJECT: 536
      - run: docker build . -t autotests
      - run: docker run --env-file env.list autotests allurectl auth login
